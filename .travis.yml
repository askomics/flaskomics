sudo: required
matrix:
  include:
    - language: python
      python:
        - 3.6
      services:
      - docker
      cache:
        - pip
      install:
        - pip install -r requirements.txt
        - python setup.py install
      before_script:
      - docker pull redis:4.0
      - docker pull askomics/virtuoso:7.2.5.1
      - docker pull bgruening/galaxy-stable:19.01
      - sudo docker run -d --name virtuoso -p 127.0.0.1:8890:8890 -p 127.0.0.1:1111:1111  -e DBA_PASSWORD=dba -e SPARQL_UPDATE=true -e DEFAULT_GRAPH=http://localhost:8890/DAV --net="host" -t askomics/virtuoso
      - sudo docker run -d --name redis --net="host" -t redis:4.0
      - sudo docker run -d --name galaxy -p 127.0.0.1:8081:80 --net="host" -t bgruening/galaxy-stable:19.01
      - sleep 1m
      script:
        - flake8 askomics tests --ignore=E501,W504
        - pytest --cov=. -vv --log-cli-level debug
      after_success:
        coveralls

    - language: node_js
      node_js:
        - 8
      install:
        - npm install
      script:
        - ./node_modules/.bin/eslint --config .eslintrc.yml "askomics/react/src/**"
